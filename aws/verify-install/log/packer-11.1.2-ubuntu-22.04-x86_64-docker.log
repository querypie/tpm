[1;32mamazon-ebs.ubuntu-22-04: output will be in this color.[0m

[1;32m==> amazon-ebs.ubuntu-22-04: skip_create_ami was set; not prevalidating AMI name[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Found Image ID: ami-02835aed2a5cb1d2a[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Creating temporary keypair: packer_68b682aa-a52d-c31d-c9cc-f70f965ae3dc[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Creating temporary security group for this instance: packer_68b682aa-215a-2b51-6920-a4f03e315d86[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Launching a spot AWS instance...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Interpolating tags for spot instance...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "CreatedBy": "Packer"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "Name": "Ubuntu22.04-Installer-11.1.2"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "Owner": "jk"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "Purpose": "Automated QueryPie Installer"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "Version": "11.1.2"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Adding tag: "BuildDate": "20250902053745"[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Loading User Data File...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Creating Spot Fleet launch template...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Created Spot Fleet launch template: lt-055bbd52f97a37b48[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Instance ID: i-05795f8b9d3d545bd[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Waiting for instance (i-05795f8b9d3d545bd) to become ready...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Using SSH communicator to connect: 3.34.44.153[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Waiting for SSH to become available...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Connected to SSH![0m
[1;32m==> amazon-ebs.ubuntu-22-04: Provisioning with shell script: /var/folders/9h/bj4nh9ss6pq0_2bkd39t0p0w0000gn/T/packer-shell102968727[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + cloud-init status --wait[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ..................status: done[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Uploading ../scripts/ => /tmp/[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Provisioning with shell script: /var/folders/9h/bj4nh9ss6pq0_2bkd39t0p0w0000gn/T/packer-shell2709414247[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + /tmp/install-docker-on-ubuntu.sh[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + DOWNLOAD_URL=https://download.docker.com/linux[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + packages=(docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-plugin docker-model-plugin)[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + main[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + test_if_docker_installed_already[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + ps ux[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + id -Gn[0m
[1;32m==> amazon-ebs.ubuntu-22-04: USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu       769  0.5  0.0  16968  9600 ?        Ss   05:38   0:00 /lib/systemd/systemd --user[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu       771  0.0  0.0 169224  5304 ?        S    05:38   0:00 (sd-pam)[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu       885  0.1  0.0  17504  8348 ?        S    05:38   0:00 sshd: ubuntu@notty[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      1540  0.0  0.0   7764  3328 ?        Ss   05:38   0:00 /bin/bash -ex /tmp/script_8846.sh[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      1542  0.0  0.0   7764  3456 ?        S    05:38   0:00 bash /tmp/install-docker-on-ubuntu.sh[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      1543  0.0  0.0  10464  3200 ?        R    05:38   0:00 ps ux[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + docker ps[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu adm dialout cdrom floppy sudo audio dip video plugdev netdev lxd[0m
[1;31m==> amazon-ebs.ubuntu-22-04: /tmp/install-docker-on-ubuntu.sh: line 45: docker: command not found[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + install_docker_and_compose[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + local lsb_dist distro_version[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + DEBIAN_FRONTEND=noninteractive[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo -E sudo apt -qq update[0m
[1;31m==> amazon-ebs.ubuntu-22-04:[0m
[1;31m==> amazon-ebs.ubuntu-22-04: WARNING: apt does not have a stable CLI interface. Use with caution in scripts.[0m
[1;31m==> amazon-ebs.ubuntu-22-04:[0m
[1;32m==> amazon-ebs.ubuntu-22-04: 5 packages can be upgraded. Run 'apt list --upgradable' to see them.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /tmp/docker.asc[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo install -m 0755 -d /etc/apt/keyrings[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo install -m 0644 /tmp/docker.asc /etc/apt/keyrings/docker.asc[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ . /etc/os-release[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ PRETTY_NAME='Ubuntu 22.04.5 LTS'[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ NAME=Ubuntu[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ VERSION_ID=22.04[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ VERSION='22.04.5 LTS (Jammy Jellyfish)'[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ VERSION_CODENAME=jammy[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ ID=ubuntu[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ ID_LIKE=debian[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ HOME_URL=https://www.ubuntu.com/[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ SUPPORT_URL=https://help.ubuntu.com/[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ BUG_REPORT_URL=https://bugs.launchpad.net/ubuntu/[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ PRIVACY_POLICY_URL=https://www.ubuntu.com/legal/terms-and-policies/privacy-policy[0m
[1;31m==> amazon-ebs.ubuntu-22-04: +++ UBUNTU_CODENAME=jammy[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ echo ubuntu[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ tr '[:upper:]' '[:lower:]'[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + lsb_dist=ubuntu[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ lsb_release --codename[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ cut -f2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + distro_version=jammy[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo tee /etc/apt/sources.list.d/docker.list[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ++ dpkg --print-architecture[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + echo 'deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu jammy stable'[0m
[1;32m==> amazon-ebs.ubuntu-22-04: deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu jammy stable[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo DEBIAN_FRONTEND=noninteractive apt -qq update[0m
[1;31m==> amazon-ebs.ubuntu-22-04:[0m
[1;31m==> amazon-ebs.ubuntu-22-04: WARNING: apt does not have a stable CLI interface. Use with caution in scripts.[0m
[1;31m==> amazon-ebs.ubuntu-22-04:[0m
[1;32m==> amazon-ebs.ubuntu-22-04: 5 packages can be upgraded. Run 'apt list --upgradable' to see them.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo DEBIAN_FRONTEND=noninteractive apt-get -y -qq install docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-plugin docker-model-plugin[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package containerd.io.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: (Reading database ... 65985 files and directories currently installed.)[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../0-containerd.io_1.7.27-1_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking containerd.io (1.7.27-1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-ce-cli.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../1-docker-ce-cli_5%3a28.3.3-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-ce-cli (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-ce.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../2-docker-ce_5%3a28.3.3-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-ce (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package pigz.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../3-pigz_2.6-1_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking pigz (2.6-1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-buildx-plugin.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../4-docker-buildx-plugin_0.26.1-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-buildx-plugin (0.26.1-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-ce-rootless-extras.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../5-docker-ce-rootless-extras_5%3a28.3.3-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-ce-rootless-extras (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-compose-plugin.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../6-docker-compose-plugin_2.39.1-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-compose-plugin (2.39.1-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package docker-model-plugin.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../7-docker-model-plugin_0.1.36-1~ubuntu.22.04~jammy_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking docker-model-plugin (0.1.36-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package libslirp0:amd64.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../8-libslirp0_4.6.1-1build1_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking libslirp0:amd64 (4.6.1-1build1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Selecting previously unselected package slirp4netns.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Preparing to unpack .../9-slirp4netns_1.0.1-2_amd64.deb ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Unpacking slirp4netns (1.0.1-2) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-buildx-plugin (0.26.1-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up containerd.io (1.7.27-1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Created symlink /etc/systemd/system/multi-user.target.wants/containerd.service → /lib/systemd/system/containerd.service.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-compose-plugin (2.39.1-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-model-plugin (0.1.36-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-ce-cli (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up libslirp0:amd64 (4.6.1-1build1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up pigz (2.6-1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-ce-rootless-extras (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up slirp4netns (1.0.1-2) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Setting up docker-ce (5:28.3.3-1~ubuntu.22.04~jammy) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Created symlink /etc/systemd/system/multi-user.target.wants/docker.service → /lib/systemd/system/docker.service.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Created symlink /etc/systemd/system/sockets.target.wants/docker.socket → /lib/systemd/system/docker.socket.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Processing triggers for man-db (2.10.2-1) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Processing triggers for libc-bin (2.35-0ubuntu3.10) ...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: NEEDRESTART-VER: 3.5[0m
[1;32m==> amazon-ebs.ubuntu-22-04: NEEDRESTART-KCUR: 6.8.0-1035-aws[0m
[1;32m==> amazon-ebs.ubuntu-22-04: NEEDRESTART-KEXP: 6.8.0-1035-aws[0m
[1;32m==> amazon-ebs.ubuntu-22-04: NEEDRESTART-KSTA: 1[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo systemctl start docker[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo systemctl enable docker[0m
[1;31m==> amazon-ebs.ubuntu-22-04: Synchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: Executing: /lib/systemd/systemd-sysv-install enable docker[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo usermod -aG docker ubuntu[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + shutdown_ssh_session[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + killall sshd[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Provisioning with shell script: /var/folders/9h/bj4nh9ss6pq0_2bkd39t0p0w0000gn/T/packer-shell3679337367[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + ps ux[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + id -Gn[0m
[1;32m==> amazon-ebs.ubuntu-22-04: USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu       769  0.1  0.0  16968  9600 ?        Ss   05:38   0:00 /lib/systemd/systemd --user[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu       771  0.0  0.0 169224  5304 ?        S    05:38   0:00 (sd-pam)[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      4052  0.0  0.0  17192  8180 ?        S    05:38   0:00 sshd: ubuntu@notty[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      4057  0.0  0.0   7764  3456 ?        Ss   05:38   0:00 /bin/bash -ex /tmp/script_9466.sh[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu      4059  0.0  0.0  10464  3328 ?        R    05:38   0:00 ps ux[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + sudo install -m 755 /tmp/setup.v2.sh /usr/local/bin/setup.v2.sh[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ubuntu adm dialout cdrom floppy sudo audio dip video plugdev netdev lxd docker[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Provisioning with shell script: /var/folders/9h/bj4nh9ss6pq0_2bkd39t0p0w0000gn/T/packer-shell3954728557[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + setup.v2.sh --yes --install 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #### setup.v2.sh - QueryPie Installer 25.09.1, /usr/bin/bash 5.1.16(1)-release on Linux x86_64 ####[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ### Install QueryPie ###[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # QP_VERSION: 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # PACKAGE_VERSION: universal[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Configure sudo privileges[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # 'sudo' will be used for privileged commands.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Install Docker engine[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Docker is already installed at /usr/bin/docker[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Verify Container Engine installation[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Docker is already running and functional.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker --version[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Docker version 28.3.3, build 980b856[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Install Docker Compose tool[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Compose Tool, docker-compose is already installed at /usr/libexec/docker/cli-plugins/docker-compose[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Compose Tool is enabled as a plugin for docker[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose version[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Docker Compose version v2.39.1[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Install configuration files: docker-compose.yml, .env, and others[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Target directory is ./querypie/11.1.2/[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ curl -fsSL https://dl.querypie.com/releases/compose/universal/package.tar.gz -o package.tar.gz[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ umask 0022[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ tar zxvf package.tar.gz -C ./querypie/11.1.2[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ rm package.tar.gz[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ sed -i.orig -e s#- \./mysql:/var/lib/mysql#- ../mysql:/var/lib/mysql# -e s#harbor.chequer.io/querypie/#docker.io/querypie/# -e s#docker.io/querypie/#docker.io/querypie/# -e s#source: /var/log/querypie#source: ../log# ./querypie/11.1.2/compose.yml[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./nginx.d/[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./nginx.d/ssl.conf[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./nginx.d/.gitkeep[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./README.md[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./systemd/[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./systemd/podman-querypie-database.service[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./systemd/podman-querypie-app.service[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./README.ja.md[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./certs/[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./certs/.gitkeep[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./skip_command_config.json.example[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./logrotate[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ cp ./querypie/11.1.2/.env.template ./querypie/11.1.2/.env[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./compose.yml[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./mysql_init/[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./mysql_init/init.sql[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./.env.template[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./skip_command_config.json[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ sed -i.orig -e s#^VERSION=.*#VERSION=11.1.2# -e s#CABINET_DATA_DIR=/data#CABINET_DATA_DIR=../data# ./querypie/11.1.2/.env[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./.gitignore[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./README.ko.md[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ./novac-compose.yml[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ mkdir -p ./querypie/mysql[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ mkdir -p ./querypie/log[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ sudo cp ./querypie/11.1.2/logrotate /etc/logrotate.d/docker-querypie[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ~/querypie/11.1.2 ~[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Verify SELinux settings[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # SELinux is not found. Skipping SELinux settings verification.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## No ./offline/images.txt file found. Skipping loading Docker images from tarball files.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Configure the .env file in ./querypie/11.1.2/[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ pushd ./querypie/11.1.2/[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Generating Docker environment file from .env to /tmp/env_file.7qwGu1[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Replacing original file .env with generated file /tmp/env_file.7qwGu1[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose --profile database --profile querypie --profile tools pull --quiet[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  redis Pulling[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  tools Pulling[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  app Pulling[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  mysql Pulling[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  tools Pulled[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  redis Pulled[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  mysql Pulled[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  app Pulled[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Start MySQL and Redis services for QueryPie[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose --profile database up --detach[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_database  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_database  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-redis-1  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-mysql-1  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-mysql-1  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-redis-1  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-redis-1  Starting[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-mysql-1  Starting[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-mysql-1  Started[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-redis-1  Started[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ sleep 20[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose --profile tools up --detach[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_tools  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_tools  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Starting[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Started[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ tools::wait_and_print_banner[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Run migrate.sh to initialize MySQL database for QueryPie[0m
[1;32m==> amazon-ebs.ubuntu-22-04: .--------------------------------------------------------.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # This process may take more than a minute if this is the first installation.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker exec querypie-tools-1 /app/script/migrate.sh runall[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  🚀 QueryPie Tools has been successfully started! 🚀   |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  Timestamp in UTC: Tue Sep  2 05:39:57 UTC 2025        |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  Timestamp in KST: Tue Sep  2 14:39:57 KST 2025        |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: '--------------------------------------------------------'[0m
[1;31m==> amazon-ebs.ubuntu-22-04: .......................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................... Done.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker exec querypie-tools-1 /app/script/migrate.sh runall[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] Tools server is ready.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie migration is started.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie migration is finished.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie Log migration is started.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie Log migration is finished.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie Snapshot migration is started.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;32m==> amazon-ebs.ubuntu-22-04: [2025-09-02 05:42:12] QueryPie Snapshot migration is finished.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose --profile tools down[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: --------------------------------------------------------------------------------[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Stopping[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Stopped[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Removing[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-tools-1  Removed[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_tools  Removing[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_tools  Removed[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Start the QueryPie container (initialization takes about 2 minutes)[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker compose --profile querypie up --detach[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_app  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Network querypie_app  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-app-1  Creating[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-app-1  Created[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-app-1  Starting[0m
[1;31m==> amazon-ebs.ubuntu-22-04:  Container querypie-app-1  Started[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker exec querypie-app-1 readyz[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ########################################################################[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #                                                                      #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #     ██████╗ ██╗   ██╗███████╗██████╗ ██╗   ██╗██████╗ ██╗███████╗    #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #    ██╔═══██╗██║   ██║██╔════╝██╔══██╗╚██╗ ██╔╝██╔══██╗██║██╔════╝    #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #    ██║   ██║██║   ██║█████╗  ██████╔╝ ╚████╔╝ ██████╔╝██║█████╗      #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #    ██║▄▄ ██║██║   ██║██╔══╝  ██╔══██╗  ╚██╔╝  ██╔═══╝ ██║██╔══╝      #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #    ╚██████╔╝╚██████╔╝███████╗██║  ██║   ██║   ██║     ██║███████╗    #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #     ╚══▀▀═╝  ╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝     ╚═╝╚══════╝    #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: #                                                                      #[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ########################################################################[0m
[1;32m==> amazon-ebs.ubuntu-22-04: .--------------------------------------------------------.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  🚀 QueryPie Server has been successfully started! 🚀  |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  Timestamp in UTC: Tue Sep  2 05:44:02 UTC 2025        |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: |  Timestamp in KST: Tue Sep  2 14:44:02 KST 2025        |[0m
[1;32m==> amazon-ebs.ubuntu-22-04: '--------------------------------------------------------'[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ~[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ popd[0m[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ~/querypie ~[0m
[1;32m==> amazon-ebs.ubuntu-22-04: ~[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Create a symbolic link 'current' pointing to 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ pushd ./querypie/[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ rm -f current[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ ln -s 11.1.2 current[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ popd[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Skip enabling systemd service for rootless Podman since Docker is used.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ### Installation completed successfully[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ### Access QueryPie at http://172.31.43.246:8000 or https://172.31.43.246:8443 in your browser[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ### Determine the public IP address of your host machine if needed[0m
[1;31m==> amazon-ebs.ubuntu-22-04: + setup.v2.sh --verify-installation[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #### setup.v2.sh - QueryPie Installer 25.09.1, /usr/bin/bash 5.1.16(1)-release on Linux x86_64 ####[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ### Verify the installation[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Verify Container Engine installation[0m
[1;31m==> amazon-ebs.ubuntu-22-04: #[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Docker is already running and functional.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Container version: 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # Current of ./querypie/current: 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # The container version is the same as the current version.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # The installation looks good so far.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Verify the QueryPie app container is running properly[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # QueryPie app container, querypie-app-1 is running.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # QueryPie version: 11.1.2[0m
[1;31m==> amazon-ebs.ubuntu-22-04: [1;36m+ docker exec querypie-app-1 readyz wait[0m[0m
[1;31m==> amazon-ebs.ubuntu-22-04: # QueryPie app container, querypie-app-1 is ready for service.[0m
[1;31m==> amazon-ebs.ubuntu-22-04: ## Installation verification completed successfully.[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping AMI creation...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping AMI region copy...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping fast-launch template setup...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping Enable AMI deprecation...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping Enable AMI deregistration protection...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping AMI modify attributes...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Skipping AMI create tags...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Terminating the source AWS instance...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Cleaning up any extra volumes...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: No volumes to clean up, skipping[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Deleting temporary security group...[0m
[1;32m==> amazon-ebs.ubuntu-22-04: Deleting temporary keypair...[0m
[1;32mBuild 'amazon-ebs.ubuntu-22-04' finished after 7 minutes 21 seconds.[0m

==> Wait completed after 7 minutes 21 seconds

==> Builds finished but no artifacts were created.
